<%= javascript_tag do %>

    var button = document.createElement("Button");
    var title = document.createElement("H1");
    var title_name = document.createTextNode("The red box.");
    var button_name = document.createTextNode("Start");
    //var form = document.createElement("div");
    //var form_input = document.createElement("input");
    var red_box = document.createElement("div");
    var game_container = document.createElement("div");
    var win_box = document.createElement("div");
    var loose_box = document.createElement("div");
    var wall_box = document.createElement("div");
    
    title.appendChild(title_name);
    button.appendChild(button_name);
    title.appendChild(button);
    //form.appendChild(form_input);
    
    
    //Appending classes and id's to created elements; this is to be able to style and manipulate them.
    //form.setAttribute("id", "j-form");
    button.setAttribute("class", "btn btn-sm btn-success");
    button.setAttribute("id", "startbutton");
    title.setAttribute("class", "turn_red well col-md-6 col-md-offset-3", "id", "title");
    title.setAttribute("id", "title");
    red_box.setAttribute("class", "redbox");
    game_container.setAttribute("class", "gamecontainer");
    win_box.setAttribute("class", "winbox");
    loose_box.setAttribute("class", "loosebox");
    wall_box.setAttribute("class", "wallbox");
    
    
    //background image
    document.body.style.backgroundImage = "url('http://www.planwallpaper.com/static/images/recycled_texture_background_by_sandeep_m-d6aeau9_PZ9chud.jpg')"
    
    //placing elements on screen
    document.body.appendChild(title);
    //document.body.appendChild(button);
    //document.body.appendChild(form);
    document.body.appendChild(game_container);
    document.body.appendChild(win_box);
    document.body.appendChild(loose_box);
    //appended last to make sure it is placed on top.
    document.body.appendChild(red_box);

    
    button.addEventListener("click", showGame);
    
    
    //General functions
    function arrayIt(array){
        array = array.split(' ');
        console.log(array);
    };
    function getRandomInt(min, max){
       return Math.floor((Math.random() * (max - min + 1) + min));
    };
    function getRandom10(min, max){
        return getRandomInt(min / 10, max / 10) * 10
    };
    
    
    
    //pick a random number for loose box top
   var randomTop = getRandom10(300, 540);
   var randomLeft = getRandom10(500, 740);
     

    

   //document.body.style.display = "none";
   red_box.style.display = "none";
   game_container.style.display = "none";
   win_box.style.display = "none";
   loose_box.style.display = "none";
   loose_box.style.top = randomTop + "px";
   loose_box.style.left = randomLeft + "px";
   
   
   //Intro
   $(document).ready(function(){
   $("#title").fadeIn(2000).slow();
   });
   
   //When pressing start button fade in game
   function showGame(){
       $("#startbutton").fadeOut(2000);
       $(".redbox").fadeIn(2000);
       $(".gamecontainer").fadeIn(2000);
       $(".winbox").fadeIn(2000);
       $(".loosebox").fadeIn(2000);
       setInterval(moveLooseBox, 50);
       setInterval(evaluateLoose, 10);
       setInterval(shiftLooseBox, 2500);
   }
   
   //x axis
   var square_x = 500;
   //y axis
   var square_y = 300;
   //top of loose box
   var loose_top = randomTop
   //left of loose box
   var loose_left = randomLeft
   //value to shift directions of loose box
   var loose_direction = 0;

//key logger
document.body.onkeydown = function(e){
   press = e || window.event
       //d key
   if(press.keyCode === 68){
       if(square_x < 740){
           square_x += 10
           red_box.style.left = square_x.toString() + "px";
           console.log(square_x);
           evaluateWin();
           console.log(loose_box.style.top);
       }
   }
   if(press.keyCode == 65){
       if(square_x > 500){
           square_x -= 10
           red_box.style.left = square_x.toString() + "px";
           console.log(square_x);
           evaluateWin();
       };
   }
   if(press.keyCode == 87){
       if(square_y > 300){
           square_y -= 10
           red_box.style.top = square_y.toString() + "px";
           console.log(square_y);
           evaluateWin();
       }
   }
   if(press.keyCode == 83){
       if(square_y < 540){
           square_y += 10
           red_box.style.top = square_y.toString() + "px";
           console.log(square_y);
           evaluateWin();
       }
   }
};
//game functions
//move loose box left and right
function shiftLooseBox(){
    randomLeft = getRandom10(500, 740);
    loose_box.style.left = randomLeft + "px";
    loose_left = randomLeft
}
//Move loose box up and down
function moveLooseBox(){
    if(loose_direction == 0){
        randomTop -= 10;
        loose_box.style.top = randomTop + "px";
        loose_top = randomTop
        if(randomTop <= 300){
            loose_direction = 1;
        }
    }
    else if(loose_direction == 1){
        randomTop += 10;
        loose_box.style.top = randomTop + "px";
        loose_top = randomTop
        if(randomTop >= 540){
            loose_direction = 0;
        }
    }
    
    
}
function evaluateWin(){
    if(square_x == 740 && square_y == 540 || square_x == 740 && square_y == 530){
    console.log("Winner!");
    title.innerHTML = "You win!";
    title.style.backgroundColor = "green";
    }
}
function evaluateLoose(){
    if(square_y == loose_top && square_x == loose_left){
    console.log("You loose!");
    title.innerHTML = "You Loose!";
    title.style.backgroundColor = "maroon";
    }
}
   
    
<% end %>
